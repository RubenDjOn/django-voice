{% extends "djangovoice/base.html" %}

{% load i18n %}
{% load url from future %}
{% load djangovoice_tags qhonuskan_votes gravatar comments %}

{% block scripts %}
  {{ block.super }}
  {% voting_script %}
{% endblock %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <h1>{{ title }}</h1>

  {% if object_list %}

    <table class="list">
      {% for feedback in object_list %}
        {% get_comment_count for feedback as comment_count %}

        <tr>
          <td class="votes">
            {% vote_buttons_for feedback "djangovoice/includes/vote_buttons.html" %}
          </td>
          <td class="status">
            <span class="feedback-type feedback-type-{{ feedback.type.slug }}">{{ feedback.type.title }}</span>
          </td>

          <td class="details">
            <h3>
              <a href="{{ feedback.get_absolute_url }}">{{ feedback.title }}</a>
              <span class="feedback-status feedback-status-{{ feedback.status.slug }}">{{ feedback.status.title }}</span>
            </h3>

            <p>
              <span class="feedback-comments">
                <a href="{{ feedback.get_absolute_url }}">
                  {{ comment_count }} {% blocktrans %}comment{{ comment_count|pluralize }}{% endblocktrans %}
                </a>
              </span>

              <span class="feedback-user">
                {% if feedback.user %}
                  {% trans "Submitted by:" %}
                  <a href="{{ feedback.user.get_absolute_url }}" class="avatar" title="{% trans "View profile" %}">
                    {% gravatar feedback.user.username 15 %}
                  </a>

                  <a href="{{ feedback.user.get_absolute_url }}" title="View profile">{% user_name feedback.user %}</a>
                {% else %}
                  {% trans "Submitted anonymously" %}
                {% endif %}
              </span>

              <span class="feedback-date">
                {% blocktrans with feedback.created|date:"d M Y" as create_date %}on {{ create_date }}{% endblocktrans %}
              </span>
            </p>
          </td>

          {% if feedback.private %}
            <td class="feedback-private">{% trans "PRIVATE" %}</td>
          {% endif %}
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>{% trans "No one has contributed any feedback yet. Be the first and submit some feedback!" %}</p>
  {% endif %}
{% endblock %}

{% block sidebar %}
  {% include "djangovoice/sidebar.html" %}
{% endblock %}
